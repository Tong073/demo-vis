!function(c,p,l){"use strict";function U(n,V){this.position=n,this.$22n=V}var b="ht",t=c[b],W=null,P=Math,n=P.PI,$=P.cos,J=P.sin,A=P.abs,a=P.max,N=P.sqrt,q=1e-5,g=t.Default,i=g.def,T=g.startAnim,B=g.createMatrix,M=g.transformVec,v=g.getInternal(),Z=v.addMethod,e=v.superCall,z=v.toPointsArray,R=v.createNormals,K=v.toFloatArray,E=v.glMV,s=(v.glPop,t.graph3d.Graph3dView,t.Math),L=s.Vector3,I=s.Matrix4,o=s.Euler,X=(s.Quaternion,v.batchShape),F=v.createNodeMatrix,G=v.getFaceInfo,C=v.transformAppend,j=v.drawFaceInfo,f=v.createAnim,h=v.cube(),x=h.is,w=h.vs,D=h.uv,O=v.ui(),V=t.Node,u=t.Shape,r="h",Y="v",k="front",m="back",d="left",S="right",H="top",y="bottom",_="dw.expanded",Q=".expanded",ae="dw.angle",jg=".angle",Mc=function(Y,F,q){i(b+"."+Y,F,q)},Vi=function(x,A,u){u?x.push(A.x,A.y):x.push(A.x,A.y,A.z)},Jp=function(){var C=new t.Math.Vector3,I=new t.Math.Vector3,D=new t.Math.Vector3;return function(Y,W,X,p,x){if(C.copy(W.$24n),I.copy(X.$24n),D.copy(p.$24n),!(D.equals(C)||I.equals(C)||I.equals(D))){if(!W.$22n||!X.$22n||!p.$22n){var H=I.sub(C).cross(D.sub(C)).normalize().multiplyScalar(1).toArray();W.$22n||(W.$22n=new ui(H)),X.$22n||(X.$22n=new ui(H)),p.$22n||(p.$22n=new ui(H))}Y.push(new ef([W,X,p],x))}}}(),Wq=function($,Q,M,U){var k,v,V,f,m=0,e=[];if(U)for(k=U.length;k>m;m+=3)v=U[m],V=U[m+1],f=U[m+2],Jp(e,new wc([Q[3*v],Q[3*v+1],Q[3*v+2]],null,M?[M[2*v],M[2*v+1],0]:W),new wc([Q[3*V],Q[3*V+1],Q[3*V+2]],null,M?[M[2*V],M[2*V+1],0]:W),new wc([Q[3*f],Q[3*f+1],Q[3*f+2]],null,M?[M[2*f],M[2*f+1],0]:W),$);else for(k=Q.length/3;k>m;m+=3)v=m,V=m+1,f=m+2,Jp(e,new wc([Q[3*v],Q[3*v+1],Q[3*v+2]],null,M?[M[2*v],M[2*v+1],0]:W),new wc([Q[3*V],Q[3*V+1],Q[3*V+2]],null,M?[M[2*V],M[2*V+1],0]:W),new wc([Q[3*f],Q[3*f+1],Q[3*f+2]],null,M?[M[2*f],M[2*f+1],0]:W),$);return e},Rc=[d,k,S,m,H,y],Yl=["",H,y],_r=Rc.concat("csg"),Mg=[0,6,12,18,24,30],yp=function(f,b,o){var H=F(f),q=[];f.appendAnchorMatrix3d(H);var h,E=b?b.getData3dUI(f):null;if(E&&E.s("shape3d")&&!E.s("csg.cull.box")&&(h=E.shapeModel,E.shapeModel||(h=v.getShapeModel(E,E.s("shape3d"))),h))for(var r=v.createNormalMatrix(H),G=0,e=Yl.length;e>G;G++){var s=Yl[G],Y=s.length?s+"_":s,d=h[Y+"vs"],U=h[Y+"uv"],C=h[Y+"is"],l=h[Y+"ns"];if(d&&d.length)for(var N,p,O,T=0,S=C?C.length:d.length/3;S>T;T+=3)C?(N=C[T],p=C[T+1],O=C[T+2]):(N=T,p=T+1,O=T+2),Jp(q,new wc(M([d[3*N],d[3*N+1],d[3*N+2]],H),l?M([l[3*N],l[3*N+1],l[3*N+2]],r):null,[U[2*N],U[2*N+1],0]),new wc(M([d[3*p],d[3*p+1],d[3*p+2]],H),l?M([l[3*p],l[3*p+1],l[3*p+2]],r):null,[U[2*p],U[2*p+1],0]),new wc(M([d[3*O],d[3*O+1],d[3*O+2]],H),l?M([l[3*O],l[3*O+1],l[3*O+2]],r):null,[U[2*O],U[2*O+1],0]),f)}if(!h)for(var G=0;6>G;G++)for(var s=Rc[G],B=Mg[G],U=o?b.getFaceUv(f,s):W,J=o?b.getFaceUvScale(f,s):W,t=o?b.getFaceUvOffset(f,s):W,L=0;2>L;L++){var I,K,_,g=x[B+3*L],A=x[B+3*L+1],X=x[B+3*L+2];if(o){if(U){var k=8*G;I=[U[2*g-k],U[2*g+1-k],0],K=[U[2*A-k],U[2*A+1-k],0],_=[U[2*X-k],U[2*X+1-k],0]}else I=[D[2*g],D[2*g+1],0],K=[D[2*A],D[2*A+1],0],_=[D[2*X],D[2*X+1],0];J&&(I[0]*=J[0],I[1]*=J[1],K[0]*=J[0],K[1]*=J[1],_[0]*=J[0],_[1]*=J[1]),t&&(I[0]+=t[0],I[1]+=t[1],K[0]+=t[0],K[1]+=t[1],_[0]+=t[0],_[1]+=t[1])}Jp(q,new wc(M([w[3*g],w[3*g+1],w[3*g+2]],H),null,I),new wc(M([w[3*A],w[3*A+1],w[3*A+2]],H),null,K),new wc(M([w[3*X],w[3*X+1],w[3*X+2]],H),null,_),f)}return qf.$15n(q)},Uq=function(F,u,Q){var Z,g=F.data.getAttaches();if(g&&g.each(function(P){P instanceof or&&P.s("attach.operation")&&(Z||(Z=[]),Z.push(P))}),Z){var z;Rc.forEach(function(a){var I=Wq(a,F[a].vs,F[a].tuv);z=z?z.concat(I):I}),z=qf.$15n(z),Z.forEach(function(O){var Y=O.s("attach.operation");z[Y]&&(z=z[Y](yp(O,F.gv,F.csg.tuv)))}),Rc.forEach(function(l){l=F[l],l.vs=[],l.ns=[],l.tuv&&(l.tuv=[])}),F.csg&&!F.csg.ns&&(F.csg.ns=[]);var m=[];if(z.$19n().forEach(function(M){var b,V=M.$10n;if(V instanceof or){if(V.s("attach.cull"))return;b=V.s("csg.cull.color"),b&&(b=v.toColorArray(b)),V="csg"}for(var p=F[V],e=p.vs,q=p.ns,g=p.tuv,W=M.$9n,k=2;k<W.length;k++)if(Vi(e,W[0].$24n),Vi(e,W[k-1].$24n),Vi(e,W[k].$24n),q&&(Vi(q,W[0].$22n),Vi(q,W[k-1].$22n),Vi(q,W[k].$22n)),g&&(Vi(g,W[0].uv,!0),Vi(g,W[k-1].uv,!0),Vi(g,W[k].uv,!0)),b)for(var c=4*(e.length/3),O=0;3>O;O++)m[--c]=b[3],m[--c]=b[2],m[--c]=b[1],m[--c]=b[0]}),m.length){for(var o=v.toColorArray(F.csg.color),b=0,x=4*(F.csg.vs.length/3);x>b;b+=4)m[b]==l&&(m[b]=o[0],m[b+1]=o[1],m[b+2]=o[2],m[b+3]=o[3]);F.csg.cs=m}}_r.forEach(function(I){var p=F[I];p.visible&&p.vs.length?(p.ns&&p.ns.length?K(p,"ns"):p.ns=R(p.vs),K(p,"vs"),K(p,"tuv"),p.cs&&K(p,"cs")):delete F[I]}),u&&(X(F,W,u,W,Q),F.clear())};Z(g,{createFrameModel:function(E,h,o,I){E=E==W?.07:E,h=h==W?E:h,o=o==W?E:o,I=I?I:{};var N=I.top,S=I.bottom,t=I.left,u=I.right,U=I.front,Z=I.back,Q=[],d=[];return U===!0?(Q.push(-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5),d.push(0,0,0,1,1,1,1,1,1,0,0,0)):U===!1||(Q.push(-.5,.5,.5,-.5,-.5,.5,-.5+E,-.5,.5,-.5+E,-.5,.5,-.5+E,.5,.5,-.5,.5,.5,.5-E,.5,.5,.5-E,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5-E,.5,.5,-.5+E,.5,.5,-.5+E,.5-h,.5,.5-E,.5-h,.5,.5-E,.5-h,.5,.5-E,.5,.5,-.5+E,.5,.5,-.5+E,-.5+h,.5,-.5+E,-.5,.5,.5-E,-.5,.5,.5-E,-.5,.5,.5-E,-.5+h,.5,-.5+E,-.5+h,.5),d.push(0,0,0,1,E,1,E,1,E,0,0,0,1-E,0,1-E,1,1,1,1,1,1,0,1-E,0,E,0,E,h,1-E,h,1-E,h,1-E,0,E,0,E,1-h,E,1,1-E,1,1-E,1,1-E,1-h,E,1-h)),Z===!0?(Q.push(-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5),d.push(1,0,0,1,1,1,0,1,1,0,0,0)):Z===!1||(Q.push(-.5,.5,-.5,-.5+E,-.5,-.5,-.5,-.5,-.5,-.5+E,-.5,-.5,-.5,.5,-.5,-.5+E,.5,-.5,.5-E,.5,-.5,.5,-.5,-.5,.5-E,-.5,-.5,.5,-.5,-.5,.5-E,.5,-.5,.5,.5,-.5,-.5+E,.5,-.5,.5-E,.5-h,-.5,-.5+E,.5-h,-.5,.5-E,.5-h,-.5,-.5+E,.5,-.5,.5-E,.5,-.5,-.5+E,-.5+h,-.5,.5-E,-.5,-.5,-.5+E,-.5,-.5,.5-E,-.5,-.5,-.5+E,-.5+h,-.5,.5-E,-.5+h,-.5),d.push(1,0,1-E,1,1,1,1-E,1,1,0,1-E,0,E,0,0,1,E,1,0,1,E,0,0,0,1-E,0,E,h,1-E,h,E,h,1-E,0,E,0,1-E,1-h,E,1,1-E,1,E,1,1-E,1-h,E,1-h)),t===!0?(Q.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5),d.push(0,0,0,1,1,1,1,1,1,0,0,0)):t===!1||(Q.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5+o,-.5,-.5,-.5+o,-.5,.5,-.5+o,-.5,.5,-.5,-.5,.5,.5-o,-.5,-.5,.5-o,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5-o,-.5,.5,-.5+o,-.5,.5-h,-.5+o,-.5,.5-h,.5-o,-.5,.5-h,.5-o,-.5,.5,.5-o,-.5,.5,-.5+o,-.5,-.5+h,-.5+o,-.5,-.5,-.5+o,-.5,-.5,.5-o,-.5,-.5,.5-o,-.5,-.5+h,.5-o,-.5,-.5+h,-.5+o),d.push(0,0,0,1,o,1,o,1,o,0,0,0,1-o,0,1-o,1,1,1,1,1,1,0,1-o,0,o,0,o,h,1-o,h,1-o,h,1-o,0,o,0,o,1-h,o,1,1-o,1,1-o,1,1-o,1-h,o,1-h)),u===!0?(Q.push(.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5),d.push(1,0,0,1,1,1,0,1,1,0,0,0)):u===!1||(Q.push(.5,.5,-.5,.5,-.5,-.5+o,.5,-.5,-.5,.5,-.5,-.5+o,.5,.5,-.5,.5,.5,-.5+o,.5,.5,.5-o,.5,-.5,.5,.5,-.5,.5-o,.5,-.5,.5,.5,.5,.5-o,.5,.5,.5,.5,.5,-.5+o,.5,.5-h,.5-o,.5,.5-h,-.5+o,.5,.5-h,.5-o,.5,.5,-.5+o,.5,.5,.5-o,.5,-.5+h,-.5+o,.5,-.5,.5-o,.5,-.5,-.5+o,.5,-.5,.5-o,.5,-.5+h,-.5+o,.5,-.5+h,.5-o),d.push(1,0,1-o,1,1,1,1-o,1,1,0,1-o,0,o,0,0,1,o,1,0,1,o,0,0,0,1-o,0,o,h,1-o,h,o,h,1-o,0,o,0,1-o,1-h,o,1,1-o,1,o,1,1-o,1-h,o,1-h)),N===!0?(Q.push(.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5),d.push(1,1,1,0,0,0,0,0,0,1,1,1)):N===!1||(Q.push(.5,.5,.5,.5,.5,-.5,.5-E,.5,-.5,.5-E,.5,-.5,.5-E,.5,.5,.5,.5,.5,-.5+E,.5,.5,-.5+E,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5+E,.5,.5,.5-E,.5,.5,.5-E,.5,.5-o,-.5+E,.5,.5-o,-.5+E,.5,.5-o,-.5+E,.5,.5,.5-E,.5,.5,.5-E,.5,-.5+o,.5-E,.5,-.5,-.5+E,.5,-.5,-.5+E,.5,-.5,-.5+E,.5,-.5+o,.5-E,.5,-.5+o),d.push(1,1,1,0,1-E,0,1-E,0,1-E,1,1,1,E,1,E,0,0,0,0,0,0,1,E,1,1-E,1,1-E,1-o,E,1-o,E,1-o,E,1,1-E,1,1-E,o,1-E,0,E,0,E,0,E,o,1-E,o)),S===!0?(Q.push(.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5),d.push(1,0,0,1,1,1,0,1,1,0,0,0)):S===!1||(Q.push(.5,-.5,.5,.5-E,-.5,-.5,.5,-.5,-.5,.5-E,-.5,-.5,.5,-.5,.5,.5-E,-.5,.5,-.5+E,-.5,.5,-.5,-.5,-.5,-.5+E,-.5,-.5,-.5,-.5,-.5,-.5+E,-.5,.5,-.5,-.5,.5,.5-E,-.5,.5,-.5+E,-.5,.5-o,.5-E,-.5,.5-o,-.5+E,-.5,.5-o,.5-E,-.5,.5,-.5+E,-.5,.5,.5-E,-.5,-.5+o,-.5+E,-.5,-.5,.5-E,-.5,-.5,-.5+E,-.5,-.5,.5-E,-.5,-.5+o,-.5+E,-.5,-.5+o),d.push(1,0,1-E,1,1,1,1-E,1,1,0,1-E,0,E,0,0,1,E,1,0,1,E,0,0,0,1-E,0,E,o,1-E,o,E,o,1-E,0,E,0,1-E,1-o,E,1,1-E,1,E,1,1-E,1-o,E,1-o)),{vs:Q,uv:d}}}),Z(t.Style,{"csg.cull.color":l,"csg.cull.box":!0,"dw.flip":!1,"dw.s3":[.999,.999,.5],"dw.t3":l,"dw.expanded":!1,"dw.toggleable":!0,"dw.axis":"left","dw.start":0,"dw.end":n/2,"dw.angle":0,"attach.cull":!1,"attach.operation":"subtract"},!0),Rc.forEach(function(F){var I={};I[F+Q]=!1,I[F+".toggleable"]=!1,I[F+".axis"]=d,I[F+".start"]=0,I[F+".end"]=n/2,I[F+jg]=0,Z(t.Style,I,!0)});var qf=function(){this.$4n=[]};qf.$15n=function(D){var r=new qf;return r.$4n=D,r},qf.prototype={clone:function(){var I=new qf;return I.$4n=this.$4n.map(function(k){return k.clone()}),I},$19n:function(){return this.$4n},union:function(P){var L=new lk(this.clone().$4n),I=new lk(P.clone().$4n);return L.$3n(I),I.$3n(L),I.$6n(),I.$3n(L),I.$6n(),L.$7n(I.$2n()),qf.$15n(L.$2n())},subtract:function(t){var J=new lk(this.clone().$4n),j=new lk(t.clone().$4n);return J.$6n(),J.$3n(j),j.$3n(J),j.$6n(),j.$3n(J),j.$6n(),J.$7n(j.$2n()),J.$6n(),qf.$15n(J.$2n())},intersect:function(G){var X=new lk(this.clone().$4n),d=new lk(G.clone().$4n);return X.$6n(),d.$3n(X),d.$6n(),X.$3n(d),d.$3n(X),X.$7n(d.$2n()),X.$6n(),qf.$15n(X.$2n())},inverse:function(){var Y=this.clone();return Y.$4n.map(function(m){m.flip()}),Y}},qf.cube=function(I){I=I||{};var G=new ui(I.center||[0,0,0]),f=I.radius?I.radius.length?I.radius:[I.radius,I.radius,I.radius]:[1,1,1];return qf.$15n([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(m){return new ef(m[0].map(function(X){var W=new ui(G.x+f[0]*(2*!!(1&X)-1),G.y+f[1]*(2*!!(2&X)-1),G.z+f[2]*(2*!!(4&X)-1));return new wc(W,new ui(m[1]))}))}))},qf.sphere=function(s){function X(c,P){c*=2*n,P*=n;var S=new ui($(c)*J(P),$(P),J(c)*J(P));l.push(new wc(x.$20n(S.$21n(B)),S))}s=s||{};for(var l,x=new ui(s.center||[0,0,0]),B=s.radius||1,d=s.slices||16,f=s.stacks||8,g=[],L=0;d>L;L++)for(var k=0;f>k;k++)l=[],X(L/d,k/f),k>0&&X((L+1)/d,k/f),f-1>k&&X((L+1)/d,(k+1)/f),X(L/d,(k+1)/f),g.push(new ef(l));return qf.$15n(g)},qf.cylinder=function(k){function x(w,q,s){var G=2*q*n,M=f.$21n($(G)).$20n(S.$21n(J(G))),L=u.$20n(C.$21n(w)).$20n(M.$21n(g)),O=M.$21n(1-A(s)).$20n(F.$21n(s));return new wc(L,O)}k=k||{};for(var u=new ui(k.start||[0,-1,0]),h=new ui(k.end||[0,1,0]),C=h.$13n(u),g=k.radius||1,N=k.slices||16,F=C.$14n(),e=A(F.y)>.5,f=new ui(e,!e,0).cross(F).$14n(),S=f.cross(F).$14n(),R=new wc(u,F.$11n()),w=new wc(h,F.$14n()),b=[],v=0;N>v;v++){var i=v/N,c=(v+1)/N;b.push(new ef([R,x(0,i,-1),x(0,c,-1)])),b.push(new ef([x(0,c,0),x(0,i,0),x(1,i,0),x(1,c,0)])),b.push(new ef([w,x(1,c,1),x(1,i,1)]))}return qf.$15n(b)};var ui=function(v,U,t){var x=this;3==arguments.length?(x.x=v,x.y=U,x.z=t):"x"in v?(x.x=v.x,x.y=v.y,x.z=v.z):(x.x=v[0],x.y=v[1],x.z=v[2])};ui.prototype={clone:function(){return new ui(this.x,this.y,this.z)},$11n:function(){return new ui(-this.x,-this.y,-this.z)},$20n:function(_){return new ui(this.x+_.x,this.y+_.y,this.z+_.z)},$13n:function(T){return new ui(this.x-T.x,this.y-T.y,this.z-T.z)},$21n:function(w){return new ui(this.x*w,this.y*w,this.z*w)},$16n:function(B){return new ui(this.x/B,this.y/B,this.z/B)},dot:function(p){return this.x*p.x+this.y*p.y+this.z*p.z},lerp:function(b,S){return this.$20n(b.$13n(this).$21n(S))},length:function(){return N(this.dot(this))},$14n:function(){return this.$16n(this.length())},cross:function(j){var o=this;return new ui(o.y*j.z-o.z*j.y,o.z*j.x-o.x*j.z,o.x*j.y-o.y*j.x)}};var wc=function(N,b,y){var Z=this;Z.$24n=new ui(N),Z.$22n=b?new ui(b):null,Z.uv=y?new ui(y):null};wc.prototype={clone:function(){var B=this;return new wc(B.$24n.clone(),B.$22n.clone(),B.uv?B.uv.clone():null)},flip:function(){this.$22n=this.$22n.$11n()},$18n:function(q,M){var N=this;return new wc(N.$24n.lerp(q.$24n,M),N.$22n.lerp(q.$22n,M),N.uv?N.uv.lerp(q.uv,M):null)}};var Gr=function(F,V){this.$22n=F,this.w=V};Gr.$17n=function(b,T,M){var O=T.$13n(b).cross(M.$13n(b)).$14n();return new Gr(O,O.dot(b))},Gr.prototype={clone:function(){return new Gr(this.$22n.clone(),this.w)},flip:function(){var D=this;D.$22n=D.$22n.$11n(),D.w=-D.w},$5n:function(v,n,u,N,F){for(var l=this,m=0,J=1,r=2,d=3,o=0,f=[],S=0;S<v.$9n.length;S++){var w=l.$22n.dot(v.$9n[S].$24n)-l.w,a=-q>w?r:w>q?J:m;o|=a,f.push(a)}switch(o){case m:(l.$22n.dot(v.$8n.$22n)>0?n:u).push(v);break;case J:N.push(v);break;case r:F.push(v);break;case d:for(var c=[],s=[],S=0;S<v.$9n.length;S++){var Y=(S+1)%v.$9n.length,I=f[S],P=f[Y],y=v.$9n[S],C=v.$9n[Y];if(I!=r&&c.push(y),I!=J&&s.push(I!=r?y.clone():y),(I|P)==d){var w=(l.w-this.$22n.dot(y.$24n))/l.$22n.dot(C.$24n.$13n(y.$24n)),T=y.$18n(C,w);c.push(T),s.push(T.clone())}}c.length>=3&&N.push(new ef(c,v.$10n)),s.length>=3&&F.push(new ef(s,v.$10n))}}};var ef=function(X,k){var P=this;P.$9n=X,P.$10n=k,P.$8n=Gr.$17n(X[0].$24n,X[1].$24n,X[2].$24n)};ef.prototype={clone:function(){var z=this.$9n.map(function(k){return k.clone()});return new ef(z,this.$10n)},flip:function(){this.$9n.reverse().map(function(S){S.flip()}),this.$8n.flip()}};var lk=function(q){var e=this;e.$8n=null,e.front=null,e.back=null,e.$4n=[],q&&e.$7n(q)};lk.prototype={clone:function(){var y=this,Z=new lk;return Z.$8n=y.$8n&&y.$8n.clone(),Z.front=y.front&&y.front.clone(),Z.back=y.back&&y.back.clone(),Z.$4n=y.$4n.map(function(v){return v.clone()}),Z},$6n:function(){for(var I=this,p=0;p<I.$4n.length;p++)I.$4n[p].flip();I.$8n&&I.$8n.flip(),I.front&&I.front.$6n(),I.back&&I.back.$6n();var G=I.front;I.front=I.back,I.back=G},$1n:function(g){var c=this;if(!c.$8n)return g.slice();for(var b=[],i=[],I=0;I<g.length;I++)c.$8n.$5n(g[I],b,i,b,i);return c.front&&(b=c.front.$1n(b)),i=c.back?c.back.$1n(i):[],b.concat(i)},$3n:function(I){var r=this;r.$4n=I.$1n(r.$4n),r.front&&r.front.$3n(I),r.back&&r.back.$3n(I)},$2n:function(){var p=this,E=p.$4n.slice();return p.front&&(E=E.concat(p.front.$2n())),p.back&&(E=E.concat(p.back.$2n())),E},$7n:function(D){var L=this;if(D.length){L.$8n||(L.$8n=D[0].$8n.clone());for(var Y=[],$=[],i=0;i<D.length;i++)this.$8n.$5n(D[i],L.$4n,L.$4n,Y,$);Y.length&&(L.front||(L.front=new lk),this.front.$7n(Y)),$.length&&(L.back||(L.back=new lk),L.back.$7n($))}}};var ll="symbol",Bm=t.Symbol=function(l,n,j){var H=this;e(Bm,H),H.s3(20,20,20),H.s({"all.visible":!1,shape:"rect"}),H.setIcon(l,n,j)};Mc("Symbol",V,{setIcon:function(c,Y,q){var F,r=this;return Bm.superClass.setIcon.call(r,c),c?(F={for3d:!0,face:"center",position:44,names:[c]},q&&(F.transaprent=!0),Y&&(F.autorotate=Y),r.addStyleIcon(ll,F)):r.removeStyleIcon(ll),r.setWidth(v.getImageWidth(g.getImage(c),r)||20),F}});var or=t.CSGNode=function(){e(or,this),this.s({shape:"rect","attach.thickness":1.001,"2d.attachable":!0})},oi={position:1,width:1,height:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,tall:1,elevation:1,anchor:1,anchorElevation:1,"s:attach.cull":1,"s:attach.operation":1};Mc("CSGNode",V,{_22Q:function(){return Pq},onPropertyChanged:function(M){var Z=this,f=Z.getHost();or.superClass.onPropertyChanged.call(Z,M),oi[M.property]&&(f instanceof oq||f instanceof or)&&f.fp("csgNodeChange",!0,!1)}});var Pq=function(S,R){e(Pq,this,[S,R])};i(Pq,O.Node3dUI,{_80o:function(F,k,m){var C=this;C._shape3d?Pq.superClass._80o.call(C,F,k,m):(E(C.gv),_r.forEach(function(L){j(C,F,k,L,m)}))},validate:function(Q,K){var r=this,m=r.gv,k=r.data;if(k.s("shape3d"))return Pq.superClass.validate.call(r,Q,K),r._shape3d=!0,void 0;r._shape3d=!1;var p=F(k,m.getMat(k));k.appendAnchorMatrix3d(p);var s=Q&&Q.uv;r.vf2("csg",s);for(var X=0;6>X;X++)for(var R=Rc[X],G=Mg[X],l=r.vf2(R,s,K),u=l.mat||p,d=l.vs,N=l.uv,v=l.tuv,e=0;2>e;e++){var f=x[G+3*e],A=x[G+3*e+1],$=x[G+3*e+2];if(C(d,u,[w[3*f],w[3*f+1],w[3*f+2]]),C(d,u,[w[3*A],w[3*A+1],w[3*A+2]]),C(d,u,[w[3*$],w[3*$+1],w[3*$+2]]),v)if(N){var i=8*X;v.push(N[2*f-i],N[2*f+1-i],N[2*A-i],N[2*A+1-i],N[2*$-i],N[2*$+1-i])}else v.push(D[2*f],D[2*f+1],D[2*A],D[2*A+1],D[2*$],D[2*$+1])}Uq(r,Q,K)},vf2:function(f,u,X){var m,v=this,x=v.gv.getFaceVisible(v.data,f);return m=G(v,f,X),m.vs=[],m.tuv=x&&(m.texture||u)?[]:W,m.visible=x,m}});var oq=t.CSGShape=function(){var a=this;e(oq,a),a.s({"shape.background":W,"2d.hostable":!0,"shape.border.width":8}),a.setTall(240),a.setElevation(120),a.setThickness(14)};Mc("CSGShape",u,{IRotatable:!1,_22Q:function(){return pm},setRotationX:function(){},setRotation:function(){},setRotationZ:function(){},setSegments:function(){}});var pm=function(V,M){e(pm,this,[V,M])};i(pm,O.Shape3dUI,{_80o:function(T,t,v){var Y=this;Y.undrawable||(E(Y.gv),_r.forEach(function(L){j(Y,T,t,L,v)}))},validate:function(i,d){var w=this,l=w.data,S=l.getPoints();if(w.undrawable=S.size()<2)return w.clear(),void 0;var p=l.isClosePath(),G=a(l._thickness/2,q),f=z(S,W,W,p);_r.forEach(function($){w.vf($,i&&i.uv,!0,d)}),p&&(w.left.visible=!1,w.right.visible=!1),w._12O(f,G),w._20Q(f);var B=l.getPointsMatrix3d(),N=t.Math.requestVector3();Rc.forEach(function(V){if(w[V])for(var O=w[V].vs,R=0,P=O.length;P>R;R+=3)N.set(O[R],O[R+1],O[R+2]).applyMatrix4(B),O[R]=N.x,O[R+1]=N.y,O[R+2]=N.z}),t.Math.releaseVector3(N),Uq(w,i,d)}});var kj=t.DoorWindow=function(){var C=this;e(kj,C),C.setElevation(100),C.s3(100,200,14)};Mc("DoorWindow",or,{IDoorWindow:!0,toggle:function(L){this.setExpanded(!this.s(_),L)},isExpanded:function(){return this.s(_)},setExpanded:function(a,I){var d=this,p=d.$25n,u=d.s(_);if(p&&(p.stop(!0),delete d.$25n),u!==a){d.beginTransaction();var Q=a?d.s("dw.end"):d.s("dw.start");d.s(_,a),I=f(I),I?(u=d.s(ae),I.action=function(R){d.s(ae,u+(Q-u)*R)},I.finishFunc=function(){d.endTransaction()},d.$25n=T(I)):(d.s(ae,Q),d.endTransaction())}},getMat:function(){var j=this,m=j.s("dw.s3"),u=j.s("dw.t3"),e=j.s("dw.flip"),w=j.s(ae);if(m||w||u||e){var A=[];if(e&&A.push({r3:[0,n,0]}),m&&A.push({s3:m}),w){m=j.getFinalScale3d();var q=j.s("dw.axis"),$=m[0]/2,K=m[1]/2;m[2]/2,q===d?A.push({t3:[$,0,0]},{r3:[0,-w,0]},{t3:[-$,0,0]}):q===S?A.push({t3:[-$,0,0]},{r3:[0,w,0]},{t3:[$,0,0]}):q===H?A.push({t3:[0,-K,0]},{r3:[-w,0,0]},{t3:[0,K,0]}):q===y?A.push({t3:[0,K,0]},{r3:[w,0,0]},{t3:[0,-K,0]}):q===Y?A.push({r3:[0,w,0]}):q===r&&A.push({r3:[w,0,0]})}return u&&A.push({t3:u}),B(A)}return W}});var jc=t.CSGBox=function(){var k=this;e(jc,k),k.setElevation(100),k.s3(100,200,100)};Mc("CSGBox",or,{ICSGBox:!0,toggleFace:function(v,y){this.setFaceExpanded(v,!this.s(v+Q),y)},isFaceExpanded:function(Y){return this.s(Y+Q)},setFaceExpanded:function(I,w,p){var Z=this,o=Z.$25n,A=Z.s(I+Q);if(o&&(o.stop(!0),delete Z.$25n),A!==w){var E=w?Z.s(I+".end"):Z.s(I+".start");Z.s(I+Q,w),p=f(p),p?(A=Z.s(I+jg),p.action=function(Q){Z.s(I+jg,A+(E-A)*Q)},Z.$25n=T(p)):Z.s(I+jg,E)}},getFaceMat:function(l){var X=this,a=X.s(l+jg);if(!a)return W;var x,T,k,d,w,j,Y=X.s(l+".axis"),O=X.getFinalScale3d(),y=X.getAnchor3d(),e=O[0]*y.x,S=O[1]*y.y,P=O[2]*y.z,Z=O[0]-e,V=O[1]-S,F=O[2]-P,g=l+"_"+Y;switch(g){case"front_left":x=-e,T=0,k=F,d=0,w=-a,j=0;break;case"front_right":x=Z,T=0,k=F,d=0,w=a,j=0;break;case"front_top":x=0,T=V,k=F,d=-a,w=0,j=0;break;case"front_bottom":x=0,T=-S,k=F,d=a,w=0,j=0;break;case"front_h":x=0,T=0,k=F,d=a,w=0,j=0;break;case"front_v":x=0,T=0,k=F,d=0,w=a,j=0;break;case"back_left":x=Z,T=0,k=-P,d=0,w=-a,j=0;break;case"back_right":x=-e,T=0,k=-P,d=0,w=a,j=0;break;case"back_top":x=0,T=V,k=-P,d=a,w=0,j=0;break;case"back_bottom":x=0,T=-S,k=-P,d=-a,w=0,j=0;break;case"back_h":x=0,T=0,k=-P,d=a,w=0,j=0;break;case"back_v":x=0,T=0,k=-P,d=0,w=a,j=0;break;case"left_left":x=-e,T=0,k=-P,d=0,w=-a,j=0;break;case"left_right":x=-e,T=0,k=F,d=0,w=a,j=0;break;case"left_top":x=-e,T=V,k=0,d=0,w=0,j=-a;break;case"left_bottom":x=-e,T=-S,k=0,d=0,w=0,j=a;break;case"left_h":x=-e,T=0,k=0,d=0,w=0,j=a;break;case"left_v":x=-e,T=0,k=0,d=0,w=a,j=0;break;case"right_left":x=Z,T=0,k=F,d=0,w=-a,j=0;break;case"right_right":x=Z,T=0,k=-P,d=0,w=a,j=0;break;case"right_top":x=Z,T=V,k=0,d=0,w=0,j=a;break;case"right_bottom":x=Z,T=-S,k=0,d=0,w=0,j=-a;break;case"right_h":x=Z,T=0,k=0,d=0,w=0,j=a;break;case"right_v":x=Z,T=0,k=0,d=0,w=a,j=0;break;case"top_left":x=-e,T=V,k=0,d=0,w=0,j=a;break;case"top_right":x=Z,T=V,k=0,d=0,w=0,j=-a;break;case"top_top":x=0,T=V,k=-P,d=-a,w=0,j=0;break;case"top_bottom":x=0,T=V,k=F,d=a,w=0,j=0;break;case"top_h":x=0,T=V,k=0,d=a,w=0,j=0;break;case"top_v":x=0,T=V,k=0,d=0,w=0,j=a;break;case"bottom_left":x=-e,T=-S,k=0,d=0,w=0,j=-a;break;case"bottom_right":x=Z,T=-S,k=0,d=0,w=0,j=a;break;case"bottom_top":x=0,T=-S,k=F,d=-a,w=0,j=0;break;case"bottom_bottom":x=0,T=-S,k=-P,d=a,w=0,j=0;break;case"bottom_h":x=0,T=-S,k=0,d=a,w=0,j=0;break;case"bottom_v":x=0,T=-S,k=0,d=0,w=0,j=a}return B([{t3:[-x,-T,-k]},{r3:[d,w,j]},{t3:[x,T,k]}])}});var af=function(S,d,H,w,p){function A(){var s,A=[],t=new L,I=new L;for(q.eachShapeModel(function(X,i,G){for(var x=0,q=i?i.length:X.length/3;q>x;x++)i?(t.fromArray(X,3*i[x]),I.fromArray(G,3*i[x])):(t.fromArray(X,3*x),I.fromArray(G,3*x)),b(A,t,I)}),A=D(A,G.set(1,0,0)),A=D(A,G.set(-1,0,0)),A=D(A,G.set(0,1,0)),A=D(A,G.set(0,-1,0)),A=D(A,G.set(0,0,1)),A=D(A,G.set(0,0,-1)),s=0;s<A.length;s++){var _=A[s];W.push(.5+_.position.x/p.x,.5-_.position.y/p.y),_.position.applyMatrix4(T),f.push(_.position.x,_.position.y,_.position.z),J.push(_.$22n.x,_.$22n.y,_.$22n.z)}}function b(j,s,$){s.applyMatrix4(a),s.applyMatrix4(V),$.transformDirection(a),$.transformDirection(V),j.push(new U(s.clone(),$.clone()))}function D(K,J){for(var Z=[],D=.5*Math.abs(p.dot(J)),$=0;$<K.length;$+=3){var R,G,m,l,L,n,j,k=0,u=K[$+0].position.dot(J)-D,A=K[$+1].position.dot(J)-D,H=K[$+2].position.dot(J)-D;switch(R=u>0,G=A>0,m=H>0,k=(R?1:0)+(G?1:0)+(m?1:0)){case 0:Z.push(K[$]),Z.push(K[$+1]),Z.push(K[$+2]);break;case 1:if(R&&(l=K[$+1],L=K[$+2],n=N(K[$],l,J,D),j=N(K[$],L,J,D)),G){l=K[$],L=K[$+2],n=N(K[$+1],l,J,D),j=N(K[$+1],L,J,D),Z.push(n),Z.push(L.clone()),Z.push(l.clone()),Z.push(L.clone()),Z.push(n.clone()),Z.push(j);break}m&&(l=K[$],L=K[$+1],n=N(K[$+2],l,J,D),j=N(K[$+2],L,J,D)),Z.push(l.clone()),Z.push(L.clone()),Z.push(n),Z.push(j),Z.push(n.clone()),Z.push(L.clone());break;case 2:R||(l=K[$].clone(),L=N(l,K[$+1],J,D),n=N(l,K[$+2],J,D),Z.push(l),Z.push(L),Z.push(n)),G||(l=K[$+1].clone(),L=N(l,K[$+2],J,D),n=N(l,K[$],J,D),Z.push(l),Z.push(L),Z.push(n)),m||(l=K[$+2].clone(),L=N(l,K[$],J,D),n=N(l,K[$+1],J,D),Z.push(l),Z.push(L),Z.push(n));break;case 3:}}return Z}function N(k,r,o,B){var e=k.position.dot(o)-B,d=r.position.dot(o)-B,i=e/(e-d),g=new U(new L(k.position.x+i*(r.position.x-k.position.x),k.position.y+i*(r.position.y-k.position.y),k.position.z+i*(r.position.z-k.position.z)),new L(k.$22n.x+i*(r.$22n.x-k.$22n.x),k.$22n.y+i*(r.$22n.y-k.$22n.y),k.$22n.z+i*(r.$22n.z-k.$22n.z)));return g}var f=[],J=[],W=[],G=new L,q=S.getData3dUI(d);if(q.mat){var a=(new I).fromArray(q.mat),g=new I;g.makeRotationFromEuler(w),g.setPosition(H);var V=(new I).getInverse(g),T=(new I).scale({x:1/p.x,y:1/p.y,z:1/p.z});return A(),{vs:f,ns:J,uv:W}}};U.prototype.clone=function(){return new U(this.position.clone(),this.$22n.clone())};var as=function(i,C,A,p){var V=this,y=V.getDataAt(i);if(y){var R=V.intersectObject(i,y);if(R){"object"==typeof C?C=C.x?new L(C.x,C.y,C.z):new L(C[0],C[1],C[2]):(C=C||20,C=new L(C,C,C)),A=A===l?.1:A;var K=new L(V.getUp()),G=new L(V.getCenter()).sub(new L(V.getEye())).normalize(),e="cross",$=G.clone()[e](K).normalize();K.copy($)[e](G).normalize(),p&&K.applyAxisAngle(R.worldNormal,-p);var w=new t.Node,Z=R.worldNormal.clone().setLength(A).add(R.world),E=(new I).lookAt(R.worldNormal.clone(),new L(0,0,0),K),z=(new o).setFromRotationMatrix(E),j=af(V,y,R.world.clone(),z,C);return w.p3(Z.x,Z.y,Z.z),w.setEuler(z),w.s3(C.x,C.y,C.z),w.s({shape3d:j,"shape3d.reverse.flip":!0}),w}}};Z(t.graph3d.Graph3dView,{createDecal:as})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);