!function(Z,M){"use strict";var o="position",Q="absolute",c="relative",b="px",e="left",i="right",S="top",x="bottom",E="display",f="none",Y="block",W=ht.Default,G=W.getInternal(),d=Math.floor,y=Math.ceil,U=Math.PI,n=null,H=Z.parseInt,I=function(K){return K.getContext("2d")},K=function(){return document},O=function(M){return K().createElement(M)},A=function(){return O("canvas")},X=function(f,u,C){f.style.setProperty(u,C,n)},L=function(N,q,g){W.def(ht.widget[N],q,g)},t=function(j,w){j.appendChild(w)},D=function(j,d){j.removeChild(d)},G=W.getInternal(),C=G.addEventListener,j=G.removeEventListener;ht.widget.RulerFrame=function(R){var y=this,Y=y._view=G.createView(null,y),W=y.$1k=A(),M=y.$2k=A(),N=y.$3k=A(),h=y.$4k=A();y._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},y._topRulerConfig={visible:!0},y._rightRulerConfig={visible:!1},y._bottomRulerConfig={visible:!1},y._leftRulerConfig={visible:!0},t(Y,W),t(Y,N),t(Y,M),t(Y,h),X(Y,o,c),X(Y,"box-sizing","border-box"),X(Y,"-moz-box-sizing","border-box"),X(W,o,Q),X(M,o,Q),X(N,o,Q),X(h,o,Q),y.$14k=function(){y.$13k=1,y.iv()},y.$15k=function(S){if(y._topRulerConfig.guideVisible||y._rightRulerConfig.guideVisible||y._bottomRulerConfig.guideVisible||y._leftRulerConfig.guideVisible||y._defaultRulerConfig.guideVisible||(y._topRulerConfig.guideTipVisible||y._rightRulerConfig.guideTipVisible||y._bottomRulerConfig.guideTipVisible||y._leftRulerConfig.guideTipVisible||y._defaultRulerConfig.guideTipVisible)&&y._component){var C=Y.getBoundingClientRect();y.$16k={x:S.clientX-C.left,y:S.clientY-C.top},y.$5k()}},y.setComponent(R)},L("RulerFrame",M,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(a){var f=this,c=f._component,h=f.getView();if(h){if(f._component=a,f.fp("component",c,a),c){var $=f.getComponentView(c);D(h,$),j(h,"mousemove",f.$15k),f.removeComponentPropertyChangeListener(c,f.$14k)}if(a){var F=f.getComponentView(a);t(h,F),X(F,o,Q),C(h,"mousemove",f.$15k),f.addComponentPropertyChangeListener(a,f.$14k)}}},addComponentPropertyChangeListener:function(Q,l){Q&&Q.mp&&Q.mp(l)},removeComponentPropertyChangeListener:function(C,q){C&&C.ump&&C.ump(q)},getComponentHZoom:function(Q){return Q&&Q.getZoom?Q.getZoom():1},getComponentVZoom:function(s){return s&&s.getZoom?s.getZoom():1},getComponentViewRect:function(r){return r&&r.getViewRect?r.getViewRect():void 0},getComponentView:function(V){return V&&V.getView?V.getView():V},invalidateComponent:function(a){a&&a.iv&&a.iv()},validateComponent:function(S){S&&S.validate&&S.validate()},$7k:function(x,B,v,I,F,N,S,C,Z,a,$,d){if(B.visible){var P=this._defaultRulerConfig,m="borderStyle",J="borderColor",T="borderWidth",L="background",o=B[m]||P[m],z=B[J]||P[J],g=B[T]||P[T],R=B.size!=n?B.size:P.size,i=B[L]||P[L],W=R+g,V=this.$6k(g,o,z,x,v,F,W,S,C,Z,a,$,d);X(x,F,"0px"),N?G.setCanvas(x,I-V,R):G.setCanvas(x,R,I-V),X(x,"background",i),X(x,E,Y)}else X(x,E,f),X(this.getComponentView(this._component),F,"0px")},$6k:function(C,S,$,L,U,v,E,G,P,d,m,R,h){var I=0;return X(L,U,C+"px "+S+" "+$),X(this.getComponentView(this._component),v,E+b),G?(X(L,P,d+b),I+=d):X(L,P,"0px"),m?(X(L,R,h+b),I+=h):X(L,R,"0px"),I},validateImpl:function(){var R=this,p=R._component,Z=R.$1k,m=R.$2k,s=R.$3k,q=R.$4k,N=R._view,l=R._defaultRulerConfig,K=R._topRulerConfig,f=R._rightRulerConfig,V=R._bottomRulerConfig,g=R._leftRulerConfig,y=l.size;if(N&&p){var D=K.size!=n?K.size:y,c=f.size!=n?f.size:y,z=V.size!=n?V.size:y,P=g.size!=n?g.size:y;R.$7k(Z,K,"border-bottom",N.offsetWidth,S,!0,g.visible,e,P,f.visible,i,c),R.$7k(m,f,"border-left",N.offsetHeight,i,!1,K.visible,S,D,V.visible,x,z),R.$7k(s,V,"border-top",N.offsetWidth,x,!0,g.visible,e,P,f.visible,i,c),R.$7k(q,g,"border-right",N.offsetHeight,e,!1,K.visible,S,D,V.visible,x,z),R.$13k?delete R.$13k:R.invalidateComponent(p),R.validateComponent(p),R.$5k()}},$5k:function(){function Y(r,g,z,E,T,f){if(g.visible){var A=I(r),Y=g[S]||D,_=g[m]!=n?g[m]:G,Q=g[x]||h,M=g[w]||B,b=g.size!=n?g.size:i,je=g[W]||P,Pn=g[N]||y,wc=g[c]||p,gc=g[Z]!=n?g[Z]:k,cr=g[X]!=n?g[X]:o,Sl=g[d]!=n?g[d]:L,Ic=g[O]!=n?g[O]:j,xo=g[u]!=n?g[u]:l,ek=g[V]!=n?g[V]:a,Zo=g[s]||ur,ws=g[R]||Jf;_&&(Y=K[f]=K.$8k(K[f]||Y,g[U]||$,g[e]||q,E?F:H,Pn)),z.call(K,A,J,C,t,v,b,E?F:H,Y,Q,M,T,je,wc);var Lf=K.$16k;(gc||cr)&&Lf&&(E?K.$9k(A,Lf.x,b,Zo,ws,gc,cr,Sl,Ic,xo,ek):K.$10k(A,Lf.y,b,Zo,ws,gc,cr,Sl,Ic,xo,ek,T))}}var K=this,T=K.$1k,E=K.$2k,f=K.$3k,_=K.$4k,r=K._topRulerConfig,Q=K._rightRulerConfig,b=K._bottomRulerConfig,A=K._leftRulerConfig,z=K._defaultRulerConfig,g=K._component,M=K.getComponentViewRect(g),F=K.getComponentHZoom(g),H=K.getComponentVZoom(g),J=M.x*F,t=J+M.width*F,C=M.y*H,v=C+M.height*H,i=K._defaultRulerConfig.size,S="defaultMajorTickSpacing",U="maxPhysicalMajorTickSpacing",e="minPhysicalMajorTickSpacing",m="tickSpacingAdaptable",x="majorTickTextFont",w="majorTickTextColor",W="majorTickColor",c="minorTickColor",Z="guideVisible",X="guideTipVisible",d="guideTipBorderColor",O="guideTipTextColor",u="guideTipTextFont",V="guideTipBackground",s="guideColor",R="guideWidth",N="minMajorTickSpacing",D=z[S],$=z[U],q=z[e],G=z[m],h=z[x],B=z[w],P=z[W],y=z[N],p=z[c],k=z[Z],o=z[X],L=z[d],j=z[O],l=z[u],a=z[V],ur=z[s],Jf=z[R];K._view&&g&&(Y(T,r,K.$11k,!0,!1,"_currentTopMajorTickSpacing"),Y(E,Q,K.$12k,!1,!0,"_currentRightMajorTickSpacing"),Y(f,b,K.$11k,!0,!0,"_currentBottomMajorTickSpacing"),Y(_,A,K.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(T,E,t,F,W){return t>T*F?T=d(E/F/W)*W:T*F>E&&(T=y(t/F/W)*W),T},getHTipText:function(F){var Z=this,C=Z._component,b=0,Q=Z._view.getBoundingClientRect();return C.lp?b=H(C.lp({x:F.x+Q.left,y:F.y}).x):b-=H(this.getComponentView(C).style.left)||0,b},$9k:function(u,h,M,n,U,C,W,p,P,_,e){var Z=this,o=Z._component;u.save(),G.translateAndScale(u,0,0,1);var R=h-(H(this.getComponentView(o).style.left)||0),I=0;if(h=Z.getHTipText(Z.$16k),C&&(u.beginPath(),u.fillStyle=n,u.rect(R,I,U,M),u.fill()),W){u.beginPath(),u.textAlign="center",u.textBaseline="middle",u.font=_;var V=u.measureText(h).width+6;u.fillStyle=e,u.rect(R-V/2,I,V,M),u.fill(),u.strokeStyle=p,u.stroke(),u.beginPath(),u.fillStyle=P,u.fillText(h,R,I+M/2)}u.restore()},getVTipText:function(M){var v=this,r=v._component,D=0,m=v._view.getBoundingClientRect();return r.lp?D=H(r.lp({x:M.x,y:M.y+m.top}).y):D-=H(this.getComponentView(r).style.top)||0,D},formatScaleText:function(l){return Math.round(l)},$10k:function(I,F,w,K,Q,k,y,a,r,T,A,E){var J=this,_=J._component;I.save(),G.translateAndScale(I,0,0,1);var M=w/2,B=F-(H(this.getComponentView(_).style.top)||0);if(F=J.getVTipText(J.$16k),k&&(I.beginPath(),I.fillStyle=K,I.rect(M-w/2,B,w,Q),I.fill()),y){I.translate(M,B),I.rotate((E?90:-90)*U/180),I.translate(-M,-B),I.beginPath(),I.textAlign="center",I.textBaseline="middle",I.font=T;var h=I.measureText(F).width+6;I.fillStyle=A,I.rect(M-h/2,B-w/2,h,w),I.fill(),I.strokeStyle=a,I.stroke(),I.fillStyle=r,I.fillText(F,M,B)}I.restore()},$11k:function(m,w,l,F,A,Z,U,z,V,S,j,O,E){m.save(),l=0;var n=w,_=F,D=(n+_)/2;w=0,F=_-n,G.translateAndScale(m,0,0,1);var r=0,i=0,s=H(Z/2),c=Z-s,J=j?0:s,f=z*U,p=f/10;w-=f,F+=f,m.clearRect(w,0,F-w,Z),m.beginPath(),m.fillStyle=E;var v=d(D/p)*p-n;for(r=v;F>r;r+=p)m.rect(r,l+J,1,c);for(r=v;r>w;r-=p)m.rect(r,l+J,1,c);for(m.fill(),J=j?0:1,m.beginPath(),m.fillStyle=O,v=d(D/f)*f-n,r=v;F>r;r+=f)m.rect(r,l+J,1,Z-1);for(r=v;r>w;r-=f)m.rect(r,l+J,1,Z-1);m.fill();var B=H(/\d+px/.exec(V)[0]),C=(B||10)/2;m.textBaseline="middle",J=j?Z-C-2:C+2,m.beginPath(),m.fillStyle=S,m.font=V;var K=d(D/f)*f/U;for(r=v,i=K;F>r;r+=f,i+=z){var N=this.getHScaleText?this.getHScaleText(r):i;m.fillText(this.formatScaleText(N),r+2,l+J)}for(r=v,i=K;r>w;r-=f,i-=z){var N=this.getHScaleText?this.getHScaleText(r):i;m.fillText(this.formatScaleText(N),r+2,l+J)}m.restore()},$12k:function(j,i,f,V,N,r,a,K,M,W,k,n,x){function z(O,v,W,G,p,L){p=Q.getVScaleText?Q.getVScaleText(W):p,p=Q.formatScaleText(p),j.translate(O+v,W),j.rotate(-G),j.translate(-O-v,-W),j.fillText(p,O+v+(L?2:1),W),j.translate(O+v,W),j.rotate(G),j.translate(-O-v,-W)}j.save(),i=0;var F=f,C=N,X=(F+C)/2;f=0,N=C-F,G.translateAndScale(j,0,0,1);var c=0,Q=this,e=0,g=H(r/2),E=r-g,_=k?0:g,I=K*a,J=I/10;f-=I,N+=I,j.clearRect(i,0,r,N-f),j.beginPath(),j.fillStyle=x;var y=d(X/J)*J-F;for(c=y;N>c;c+=J)j.rect(i+_,c,E,1);for(c=y;c>f;c-=J)j.rect(i+_,c,E,1);for(j.fill(),_=k?0:1,j.beginPath(),j.fillStyle=n,y=d(X/I)*I-F,c=y;N>c;c+=I)j.rect(i+_,c,r-1,1);for(c=y;c>f;c-=I)j.rect(i+_,c,r-1,1);j.fill();var p=H(/\d+px/.exec(M)[0]),u=(p||10)/2,D=90*U/180;j.textBaseline="middle",_=k?r-u:u+2,D=k?-D:D,j.beginPath(),j.fillStyle=W,j.font=M;var L=d(X/I)*I/a;for(c=y,e=L;N>c;c+=I,e+=K)z(i,_,c,D,e,k);for(c=y,e=L;c>f;c-=I,e-=K)z(i,_,c,D,e,k);j.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var h=this,J=h._component,A=h._view;J&&h.removeComponentPropertyChangeListener(J,h.$14k),A&&(j(A,"mousemove",h.$15k),D(A.parentNode,A),h._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);